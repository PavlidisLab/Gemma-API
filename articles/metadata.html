<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A guide to metadata for samples and differential expression analyses â€¢ gemma.R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A guide to metadata for samples and differential expression analyses">
<meta property="og:description" content="gemma.R">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=TODO"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'TODO');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gemma.R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gemma.R.html">Accessing curated gene expression data with gemma.R</a>
    </li>
    <li>
      <a href="../articles/metadata.html">A guide to metadata for samples and differential expression analyses</a>
    </li>
    <li>
      <a href="../articles/metanalysis.html">A meta analysis on effects of Parkinson's Disease using Gemma.R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PavlidisLab/gemma.R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="metadata_files/kePrint-0.0.1/kePrint.js"></script><link href="metadata_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A guide to metadata for samples and differential
expression analyses</h1>
                        <h4 data-toc-skip class="author">B. Ogan
Mancarci</h4>
            <address class="author_afil">
      Michael Smith Laboratories, University of British Columbia,
Vancouver, Canada<br><small class="dont-index">Source: <a href="https://github.com/PavlidisLab/gemma.R/blob/HEAD/vignettes/metadata.Rmd" class="external-link"><code>vignettes/metadata.Rmd</code></a></small>
      <div class="hidden name"><code>metadata.Rmd</code></div>

    </address>
</div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pavlidislab.github.io/gemma.R/" class="external-link">gemma.R</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://yihui.org/knitr/" class="external-link">knitr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://haozhu233.github.io/kableExtra/" class="external-link">kableExtra</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The data in Gemma are manually annotated by curators with terms,
often using an ontology term on both dataset and sample level. In
Gemma.R three primary functions allow access to these annotations for a
given dataset.</p>
<ul>
<li><p><code>get_dataset_annotations</code>: This function returns
annotations associated with a dataset. These try to serve as tags
describing the dataset as a whole and they characteristics that samples
within the datasets have while also including some additional
terms.</p></li>
<li><p><code>get_dataset_samples</code>: This function returns samples
and associated annotations related to their experimental groups for an
experiment</p></li>
<li><p><code>get_dataset_differential_expression_analyses</code>: This
function returns information about differential expression analyses
automatically performed by Gemma for a given experiment. Each row of the
output is a contrast where a specific property or an interaction of
properties are described.</p></li>
</ul>
<p>In the examples below we will be referring to <a href="https://gemma.msl.ubc.ca/expressionExperiment/showExpressionExperiment.html?id=2914" class="external-link">GSE18728</a>
experiment, where drug resistant cancer patients and</p>
</div>
<div class="section level2">
<h2 id="dataset-tags">Dataset tags<a class="anchor" aria-label="anchor" href="#dataset-tags"></a>
</h2>
<p>Terms returned via <code>get_dataset_annotations</code> are tags used
to describe a dataset in general terms.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_dataset_annotations.html">get_dataset_annotations</a></span><span class="op">(</span><span class="st">'GSE18728'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
class.name
</th>
<th style="text-align:left;">
class.URI
</th>
<th style="text-align:left;">
term.name
</th>
<th style="text-align:left;">
term.URI
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
disease
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000408" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000408</a>
</td>
<td style="text-align:left;">
breast cancer
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/MONDO_0007254" class="external-link uri">http://purl.obolibrary.org/obo/MONDO_0007254</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000651" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000651</a>
</td>
<td style="text-align:left;">
docetaxel trihydrate
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/CHEBI_59809" class="external-link uri">http://purl.obolibrary.org/obo/CHEBI_59809</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000727" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000727</a>
</td>
<td style="text-align:left;">
capecitabine
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/CHEBI_31348" class="external-link uri">http://purl.obolibrary.org/obo/CHEBI_31348</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000651" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000651</a>
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/PATO_0001178" class="external-link uri">http://purl.obolibrary.org/obo/PATO_0001178</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
organism part
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000635" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000635</a>
</td>
<td style="text-align:left;">
mammary gland
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/UBERON_0001911" class="external-link uri">http://purl.obolibrary.org/obo/UBERON_0001911</a>
</td>
</tr>
</tbody>
</table>
<p>These tags come as a class/term pairs and inherit any terms that is
assigned to any of the samples. Therefore we can see all chemicals and
cell types used in the experiment.</p>
</div>
<div class="section level2">
<h2 id="factor-values">Factor values<a class="anchor" aria-label="anchor" href="#factor-values"></a>
</h2>
<p>Samples and differential expression contrasts in Gemma are annotated
with factor values. These values contain statements that describe these
samples and which samples belong to which experimental in a differential
expression analysis respectively.</p>
<div class="section level3">
<h3 id="sample-factor-values">Sample factor values<a class="anchor" aria-label="anchor" href="#sample-factor-values"></a>
</h3>
<p>In gemma.R these values are stored in nested <code>data.table</code>s
and can be found by accessing the relevant columns of the outputs.
Annotations for samples can be accessed using
<code>get_dataset_samples</code>. <code>sample.factorValues</code>
column contains the relevant information</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_samples.html">get_dataset_samples</a></span><span class="op">(</span><span class="st">'GSE18728'</span><span class="op">)</span></span>
<span><span class="va">samples</span><span class="op">$</span><span class="va">sample.factorValues</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
category.URI
</th>
<th style="text-align:left;">
value
</th>
<th style="text-align:left;">
value.URI
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
predicate.URI
</th>
<th style="text-align:left;">
object
</th>
<th style="text-align:left;">
object.URI
</th>
<th style="text-align:left;">
summary
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
factor.ID
</th>
<th style="text-align:left;">
factor.category
</th>
<th style="text-align:left;">
factor.category.URI
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
collection of material
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0005066" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0005066</a>
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
<a href="http://gemma.msl.ubc.ca/ont/TGEMO_00013" class="external-link uri">http://gemma.msl.ubc.ca/ont/TGEMO_00013</a>
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:right;">
134952
</td>
<td style="text-align:right;">
24474
</td>
<td style="text-align:left;">
collection of material
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0005066" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0005066</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
block
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0005067" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0005067</a>
</td>
<td style="text-align:left;">
Batch_09_5/20/05
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
Batch_09_5/20/05
</td>
<td style="text-align:right;">
184673
</td>
<td style="text-align:right;">
39147
</td>
<td style="text-align:left;">
block
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0005067" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0005067</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000651" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000651</a>
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/PATO_0001178" class="external-link uri">http://purl.obolibrary.org/obo/PATO_0001178</a>
</td>
<td style="text-align:left;">
toward
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/RO_0002503" class="external-link uri">http://purl.obolibrary.org/obo/RO_0002503</a>
</td>
<td style="text-align:left;">
capecitabine
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/CHEBI_31348" class="external-link uri">http://purl.obolibrary.org/obo/CHEBI_31348</a>
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:right;">
76119
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000651" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000651</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000651" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000651</a>
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/PATO_0001178" class="external-link uri">http://purl.obolibrary.org/obo/PATO_0001178</a>
</td>
<td style="text-align:left;">
toward
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/RO_0002503" class="external-link uri">http://purl.obolibrary.org/obo/RO_0002503</a>
</td>
<td style="text-align:left;">
docetaxel trihydrate
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/CHEBI_59809" class="external-link uri">http://purl.obolibrary.org/obo/CHEBI_59809</a>
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:right;">
76119
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000651" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000651</a>
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000727" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000727</a>
</td>
<td style="text-align:left;">
reference substance role
</td>
<td style="text-align:left;">
<a href="http://purl.obolibrary.org/obo/OBI_0000025" class="external-link uri">http://purl.obolibrary.org/obo/OBI_0000025</a>
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
reference substance role
</td>
<td style="text-align:right;">
134950
</td>
<td style="text-align:right;">
24473
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
<a href="http://www.ebi.ac.uk/efo/EFO_0000727" class="external-link uri">http://www.ebi.ac.uk/efo/EFO_0000727</a>
</td>
</tr>
</tbody>
</table>
<p>The example above shows a single factor value object for one sample.
The rows of this <code>data.table</code> are statements that belong to a
factor value. Below each column of this nested table is described. If a
given field is filled by an ontology term, the corresponding URI column
will contain the ontology URI for the field.</p>
<ul>
<li>
<code>category</code>/<code>category.URI</code>: Category of the
individual statement, such as treatment, phenotype or strain</li>
<li>
<code>value</code>/<code>value.URI</code>: The subject of the
statement.</li>
<li>
<code>predicate</code>/<code>predicate.URI</code>: When a subject
alone is not enough to describe all details, a statement can contain a
predicate and an object. The predicate describes the relationship
between the subject of the statement and the object. In the example
above, these are used to represent resistance to cancer drugs.</li>
<li>
<code>object</code>/<code>object.URI</code>: The object of a
statement is a property further describing itâ€™s value such as the dosage
of a drug or a timepoint.</li>
<li>
<code>summary</code>: A plain text summary of the factorValue.
Different statements will have the same summary if they are part of the
same factor value</li>
<li>
<code>ID</code>: An integer identifier for the specific factor
value. In the example above, phenotype of the patient is defined as a
single factor value made up of two statements stating that the patient
is resistant to both capecitabine and docetaxel trihydrate. This factor
value has the ID of 76119 which is shared by both rows containing the
statements describing it. This ID will repeat for every other patient
that has the same drug resistance or differential expression results
using that factor as a part of their contrast. For instance we can see
which samples that was subjected to this condition using this ID instead
of trying to match the other columns describing the statements</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">samples</span><span class="op">$</span><span class="va">sample.factorValues</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="st">'resistant to'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="op">{</span><span class="va">.</span><span class="op">$</span><span class="va">ID</span><span class="op">}</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span></span>
<span></span>
<span><span class="co"># count how many patients has this phenotype</span></span>
<span><span class="va">samples</span><span class="op">$</span><span class="va">sample.factorValues</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span><span class="op">$</span><span class="va">ID</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">sum</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 38</span></span></code></pre>
<ul>
<li>
<code>factor.ID</code>: An integer identifier for the factor. A
factor holds specific factor values. For the example above whether or
not a patient has drug resistance is stored under the id</li>
</ul>
<p>We can use this to fetch all distinct phenotypes</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">id</span> <span class="op">&lt;-</span> <span class="va">samples</span><span class="op">$</span><span class="va">sample.factorValues</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">value</span> <span class="op">==</span> <span class="st">'resistant to'</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="op">{</span><span class="va">.</span><span class="op">$</span><span class="va">factor.ID</span><span class="op">}</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span></span>
<span></span>
<span><span class="va">samples</span><span class="op">$</span><span class="va">sample.factorValues</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span>\<span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">x</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">factor.ID</span> <span class="op">==</span> <span class="va">id</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="op">{</span><span class="va">.</span><span class="op">$</span><span class="va">summary</span><span class="op">}</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unlist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "resistant to toward capecitabine, resistant to toward docetaxel trihydrate"</span></span>
<span><span class="co">## [2] "reference subject role"</span></span></code></pre>
<p>This shows us the dataset has control patients and patients who are
resistant to capecitabine and trihydrate. . This ID can be used to match
the factor between samples and between samples and differential
expression experiments -
<code>factor.category</code>/<code>factor.category.URI</code>: The
category of the whole factor. Usually this is the same with the
<code>category</code> of the statements making up the factor value.
However in cases like the example above, where the value describes a
treatment while the factor overall represents a phenotype, they can
differ.</p>
<p>gemma.R includes a convenience function to create a simplified design
matrix out of these factor values for a given experiment. This will
unpack the nested data.frames and provide a more human readable output,
giving each available factor itâ€™s own column.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/make_design.html">make_design</a></span><span class="op">(</span><span class="va">samples</span><span class="op">)</span></span>
<span><span class="va">design</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  <span class="co"># first column is just a copy of the original factor values</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
collection of material
</th>
<th style="text-align:left;">
block
</th>
<th style="text-align:left;">
phenotype
</th>
<th style="text-align:left;">
treatment
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
pt15.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_09_5/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt3.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_07_5/18/05
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt11.or
</td>
<td style="text-align:left;">
DE_Exclude
</td>
<td style="text-align:left;">
Batch_05_4/19/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
pt24.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_06_4/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt29.or
</td>
<td style="text-align:left;">
DE_Exclude
</td>
<td style="text-align:left;">
Batch_01_3/8/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
</td>
</tr>
<tr>
<td style="text-align:left;">
pt20.or
</td>
<td style="text-align:left;">
DE_Exclude
</td>
<td style="text-align:left;">
Batch_04_4/7/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
</td>
</tr>
</tbody>
</table>
<p>Using this output, here we look at the sample sizes for different
experimental groups.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">treatment</span>,<span class="va">phenotype</span>,<span class="va">`collection of material`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarize</a></span><span class="op">(</span>n<span class="op">=</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## `summarise()` has grouped output by 'treatment', 'phenotype'. You can override</span></span>
<span><span class="co">## using the `.groups` argument.</span></span></code></pre>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
treatment
</th>
<th style="text-align:left;">
phenotype
</th>
<th style="text-align:left;">
collection of material
</th>
<th style="text-align:right;">
n
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
DE_Exclude
</td>
<td style="text-align:right;">
16
</td>
</tr>
<tr>
<td style="text-align:left;">
reference substance role
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:right;">
13
</td>
</tr>
<tr>
<td style="text-align:left;">
docetaxel trihydrate, capecitabine
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
docetaxel trihydrate, capecitabine
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:right;">
9
</td>
</tr>
<tr>
<td style="text-align:left;">
reference substance role
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:right;">
8
</td>
</tr>
<tr>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
DE_Exclude
</td>
<td style="text-align:right;">
6
</td>
</tr>
</tbody>
</table>
</div>
<div class="section level3">
<h3 id="differential-expression-analysis-factor-values">Differential expression analysis factor values<a class="anchor" aria-label="anchor" href="#differential-expression-analysis-factor-values"></a>
</h3>
<p>For most experiments it contains, Gemma performs automated
differential expression analyses. The kinds of analyses that will be
performed is informed by the factor values belonging to the samples.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># removing columns containing factor values and URIs for brevity</span></span>
<span><span class="va">remove_columns</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'baseline.factors'</span>,<span class="st">'experimental.factors'</span>,<span class="st">'subsetFactor'</span>,<span class="st">'factor.category.URI'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dea</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_dataset_differential_expression_analyses.html">get_dataset_differential_expression_analyses</a></span><span class="op">(</span><span class="st">"GSE18728"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">dea</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="op">!</span><span class="va">remove_columns</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
result.ID
</th>
<th style="text-align:left;">
contrast.ID
</th>
<th style="text-align:right;">
experiment.ID
</th>
<th style="text-align:left;">
factor.category
</th>
<th style="text-align:left;">
factor.ID
</th>
<th style="text-align:left;">
subsetFactor.subset
</th>
<th style="text-align:right;">
probes.analyzed
</th>
<th style="text-align:right;">
genes.analyzed
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
506927
</td>
<td style="text-align:left;">
76119
</td>
<td style="text-align:right;">
2914
</td>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
11430
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
54667
</td>
<td style="text-align:right;">
21298
</td>
</tr>
<tr>
<td style="text-align:right;">
506926
</td>
<td style="text-align:left;">
76119_134951
</td>
<td style="text-align:right;">
2914
</td>
<td style="text-align:left;">
phenotype,treatment
</td>
<td style="text-align:left;">
11430,24473
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
54667
</td>
<td style="text-align:right;">
21298
</td>
</tr>
<tr>
<td style="text-align:right;">
506925
</td>
<td style="text-align:left;">
134951
</td>
<td style="text-align:right;">
2914
</td>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
24473
</td>
<td style="text-align:left;">
TRUE
</td>
<td style="text-align:right;">
54666
</td>
<td style="text-align:right;">
21298
</td>
</tr>
</tbody>
</table>
<p>The example above shows the differential expression analyses results.
Each row of this data.table represents a differential expression
contrast connected to a fold change and a p value in the output of
<code>get_differential_expression_values</code> function. If we look at
the <code>contrast.ID</code> we will see the factor value identifiers
returned in the <code>ID</code> column of our
<code>sample.factorValues</code>. These represent which factor value is
used as the experimental factor. Note that some rows will have two IDs
appended together. These represent the interaction effects of multiple
factors. For simplicty, we will start from a contrast without an
interaction.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="va">dea</span><span class="op">[</span><span class="fl">1</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># removing URIs for brevity</span></span>
<span><span class="va">uri_columns</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'category.URI'</span>,</span>
<span>                <span class="st">'object.URI'</span>,</span>
<span>                <span class="st">'value.URI'</span>,</span>
<span>                <span class="st">'predicate.URI'</span>,</span>
<span>                <span class="st">'factor.category.URI'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">contrast</span><span class="op">$</span><span class="va">baseline.factors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="op">!</span><span class="va">uri_columns</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
value
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
object
</th>
<th style="text-align:left;">
summary
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
factor.ID
</th>
<th style="text-align:left;">
factor.category
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:right;">
76118
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
</tr></tbody>
</table>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span><span class="op">$</span><span class="va">experimental.factors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="op">!</span><span class="va">uri_columns</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
value
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
object
</th>
<th style="text-align:left;">
summary
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
factor.ID
</th>
<th style="text-align:left;">
factor.category
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
toward
</td>
<td style="text-align:left;">
capecitabine
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:right;">
76119
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
</tr>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
toward
</td>
<td style="text-align:left;">
docetaxel trihydrate
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:right;">
76119
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
</tr>
</tbody>
</table>
<p>Here, we can see the baseline is the non-resistant controls, being
compared to drug resistant patients.</p>
<p>If we examine a factor with interaction, both baseline and
experimental factor value columns will contain two factor values.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span> <span class="op">&lt;-</span> <span class="va">dea</span><span class="op">[</span><span class="fl">2</span>,<span class="op">]</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span><span class="op">$</span><span class="va">baseline.factors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="op">!</span><span class="va">uri_columns</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
value
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
object
</th>
<th style="text-align:left;">
summary
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
factor.ID
</th>
<th style="text-align:left;">
factor.category
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:right;">
76118
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
reference substance role
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
reference substance role
</td>
<td style="text-align:right;">
134950
</td>
<td style="text-align:right;">
24473
</td>
<td style="text-align:left;">
treatment
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span><span class="op">$</span><span class="va">experimental.factors</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="op">!</span><span class="va">uri_columns</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
value
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
object
</th>
<th style="text-align:left;">
summary
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
factor.ID
</th>
<th style="text-align:left;">
factor.category
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
toward
</td>
<td style="text-align:left;">
capecitabine
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:right;">
76119
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
</tr>
<tr>
<td style="text-align:left;">
phenotype
</td>
<td style="text-align:left;">
resistant to
</td>
<td style="text-align:left;">
toward
</td>
<td style="text-align:left;">
docetaxel trihydrate
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:right;">
76119
</td>
<td style="text-align:right;">
11430
</td>
<td style="text-align:left;">
phenotype
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
capecitabine
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
docetaxel trihydrate, capecitabine
</td>
<td style="text-align:right;">
134951
</td>
<td style="text-align:right;">
24473
</td>
<td style="text-align:left;">
treatment
</td>
</tr>
<tr>
<td style="text-align:left;">
treatment
</td>
<td style="text-align:left;">
docetaxel trihydrate
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
docetaxel trihydrate, capecitabine
</td>
<td style="text-align:right;">
134951
</td>
<td style="text-align:right;">
24473
</td>
<td style="text-align:left;">
treatment
</td>
</tr>
</tbody>
</table>
<p>A third place that can contain factorValues is the
<code>subsetFactor</code>. Certain differential expression analyses
disclude certain samples based on a given factor. In this example we can
see the curators added a specific factor to remove some samples from
differential expression analyses</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">contrast</span><span class="op">$</span><span class="va">subsetFactor</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="op">!</span><span class="va">uri_columns</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>     <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
category
</th>
<th style="text-align:left;">
value
</th>
<th style="text-align:left;">
predicate
</th>
<th style="text-align:left;">
object
</th>
<th style="text-align:left;">
summary
</th>
<th style="text-align:right;">
ID
</th>
<th style="text-align:right;">
factor.ID
</th>
<th style="text-align:left;">
factor.category
</th>
</tr></thead>
<tbody><tr>
<td style="text-align:left;">
collection of material
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
NA
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:right;">
134952
</td>
<td style="text-align:right;">
24474
</td>
<td style="text-align:left;">
NA
</td>
</tr></tbody>
</table>
<p>Looking at the design table we made above, you can see that these
were samples where treatment was not specified.</p>
<p>The ids of the factor values included in
<code>baseline.factors</code> and <code>experimental.factors</code>
along with <code>subsetFactor</code> can be used to determine which
samples represent a given contrast. For convenience,
<code>get_dataset_object</code> function which is used to compile
metadata and expression data of an experiment in a single object,
includes <code>resultSets</code> and <code>contrasts</code> argument
which will return the data already composed of samples representing a
particular contrast.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obj</span> <span class="op">&lt;-</span>  <span class="fu"><a href="../reference/get_dataset_object.html">get_dataset_object</a></span><span class="op">(</span><span class="st">"GSE18728"</span>,resultSets <span class="op">=</span> <span class="va">contrast</span><span class="op">$</span><span class="va">result.ID</span>,contrasts <span class="op">=</span> <span class="va">contrast</span><span class="op">$</span><span class="va">contrast.ID</span>,type <span class="op">=</span> <span class="st">'list'</span><span class="op">)</span></span>
<span><span class="va">obj</span><span class="op">$</span><span class="va">`2914.506926.76119_134951`</span><span class="op">$</span><span class="va">design</span><span class="op">[</span>,<span class="op">-</span><span class="fl">1</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:left;">
collection of material
</th>
<th style="text-align:left;">
block
</th>
<th style="text-align:left;">
phenotype
</th>
<th style="text-align:left;">
treatment
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
pt15.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_09_5/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt3.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_07_5/18/05
</td>
<td style="text-align:left;">
reference subject role
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt24.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_06_4/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt17.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_06_4/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt26.bl
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_09_5/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
reference substance role
</td>
</tr>
<tr>
<td style="text-align:left;">
pt17.c2
</td>
<td style="text-align:left;">
DE_Include
</td>
<td style="text-align:left;">
Batch_06_4/20/05
</td>
<td style="text-align:left;">
resistant to toward capecitabine, resistant to toward docetaxel
trihydrate
</td>
<td style="text-align:left;">
docetaxel trihydrate, capecitabine
</td>
</tr>
</tbody>
</table>
<p>We suggested that the <code>contrast.ID</code> of a contrast also
corresponded to a column in the differential expression results,
acquired by <code>get_differential_expression_values</code>. We can use
what we have learned to take a look at the expression of genes at the
top of the phenotype, treatment interaction. Each result.ID returns its
separate table when accessing diferential expression values.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dif_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/get_differential_expression_values.html">get_differential_expression_values</a></span><span class="op">(</span><span class="st">'GSE18728'</span><span class="op">)</span></span>
<span><span class="va">dif_vals</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">contrast</span><span class="op">$</span><span class="va">result.ID</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>  </span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Probe
</th>
<th style="text-align:left;">
NCBIid
</th>
<th style="text-align:left;">
GeneSymbol
</th>
<th style="text-align:left;">
GeneName
</th>
<th style="text-align:right;">
pvalue
</th>
<th style="text-align:right;">
corrected_pvalue
</th>
<th style="text-align:right;">
rank
</th>
<th style="text-align:right;">
contrast_76119_134951_log2fc
</th>
<th style="text-align:right;">
contrast_76119_134951_tstat
</th>
<th style="text-align:right;">
contrast_76119_134951_pvalue
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
1554277_s_at
</td>
<td style="text-align:left;">
57697
</td>
<td style="text-align:left;">
FANCM
</td>
<td style="text-align:left;">
FA complementation group M
</td>
<td style="text-align:right;">
0.6078
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.6006
</td>
<td style="text-align:right;">
-0.0577
</td>
<td style="text-align:right;">
-0.5180
</td>
<td style="text-align:right;">
0.6078
</td>
</tr>
<tr>
<td style="text-align:left;">
220321_s_at
</td>
<td style="text-align:left;">
79635
</td>
<td style="text-align:left;">
CCDC121
</td>
<td style="text-align:left;">
coiled-coil domain containing 121
</td>
<td style="text-align:right;">
0.7814
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.7752
</td>
<td style="text-align:right;">
0.0890
</td>
<td style="text-align:right;">
0.2797
</td>
<td style="text-align:right;">
0.7814
</td>
</tr>
<tr>
<td style="text-align:left;">
1555928_at
</td>
<td style="text-align:left;">
79937
</td>
<td style="text-align:left;">
CNTNAP3
</td>
<td style="text-align:left;">
contactin associated protein family member 3
</td>
<td style="text-align:right;">
0.2188
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.2029
</td>
<td style="text-align:right;">
-0.7076
</td>
<td style="text-align:right;">
-1.2530
</td>
<td style="text-align:right;">
0.2188
</td>
</tr>
<tr>
<td style="text-align:left;">
210099_at
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:left;">
</td>
<td style="text-align:right;">
0.5568
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.5484
</td>
<td style="text-align:right;">
0.1038
</td>
<td style="text-align:right;">
0.5935
</td>
<td style="text-align:right;">
0.5568
</td>
</tr>
<tr>
<td style="text-align:left;">
224876_at
</td>
<td style="text-align:left;">
134553
</td>
<td style="text-align:left;">
C5orf24
</td>
<td style="text-align:left;">
chromosome 5 open reading frame 24
</td>
<td style="text-align:right;">
0.7132
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.7073
</td>
<td style="text-align:right;">
0.0801
</td>
<td style="text-align:right;">
0.3706
</td>
<td style="text-align:right;">
0.7132
</td>
</tr>
<tr>
<td style="text-align:left;">
209958_s_at
</td>
<td style="text-align:left;">
27241
</td>
<td style="text-align:left;">
BBS9
</td>
<td style="text-align:left;">
Bardet-Biedl syndrome 9
</td>
<td style="text-align:right;">
0.6395
</td>
<td style="text-align:right;">
0.9999
</td>
<td style="text-align:right;">
0.6325
</td>
<td style="text-align:right;">
0.1083
</td>
<td style="text-align:right;">
0.4727
</td>
<td style="text-align:right;">
0.6395
</td>
</tr>
</tbody>
</table>
<p>To get the top genes found associated with this interaction we access
the columns with the correct <code>contrast.ID</code>.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># getting the top 10 genes</span></span>
<span><span class="va">top_genes</span> <span class="op">&lt;-</span> <span class="va">dif_vals</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">contrast</span><span class="op">$</span><span class="va">result.ID</span><span class="op">)</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html" class="external-link">across</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'contrast_'</span>,<span class="va">contrast</span><span class="op">$</span><span class="va">contrast.ID</span>,<span class="st">'_pvalue'</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">GeneSymbol</span><span class="op">!=</span><span class="st">''</span> <span class="op">|</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"|"</span>,<span class="va">GeneSymbol</span>,fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="co"># remove blank genes or probes with multiple genes</span></span>
<span>    <span class="op">{</span><span class="va">.</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="op">]</span><span class="op">}</span></span>
<span><span class="va">top_genes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Probe</span>,<span class="va">NCBIid</span>,<span class="va">GeneSymbol</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/knitr/man/kable.html" class="external-link">kable</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/kableExtra/man/kable_styling.html" class="external-link">kable_styling</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
Probe
</th>
<th style="text-align:left;">
NCBIid
</th>
<th style="text-align:left;">
GeneSymbol
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
207409_at
</td>
<td style="text-align:left;">
3950
</td>
<td style="text-align:left;">
LECT2
</td>
</tr>
<tr>
<td style="text-align:left;">
237484_at
</td>
<td style="text-align:left;">
440087
</td>
<td style="text-align:left;">
SMCO3
</td>
</tr>
<tr>
<td style="text-align:left;">
214618_at
</td>
<td style="text-align:left;">
8837
</td>
<td style="text-align:left;">
CFLAR
</td>
</tr>
<tr>
<td style="text-align:left;">
215423_at
</td>
<td style="text-align:left;">
10299
</td>
<td style="text-align:left;">
MARCHF6
</td>
</tr>
<tr>
<td style="text-align:left;">
201543_s_at
</td>
<td style="text-align:left;">
56681
</td>
<td style="text-align:left;">
SAR1A
</td>
</tr>
<tr>
<td style="text-align:left;">
224643_at
</td>
<td style="text-align:left;">
133619
</td>
<td style="text-align:left;">
PRRC1
</td>
</tr>
<tr>
<td style="text-align:left;">
217791_s_at
</td>
<td style="text-align:left;">
5832
</td>
<td style="text-align:left;">
ALDH18A1
</td>
</tr>
<tr>
<td style="text-align:left;">
222416_at
</td>
<td style="text-align:left;">
5832
</td>
<td style="text-align:left;">
ALDH18A1
</td>
</tr>
<tr>
<td style="text-align:left;">
243843_at
</td>
<td style="text-align:left;">
90634
</td>
<td style="text-align:left;">
N4BP2L1
</td>
</tr>
<tr>
<td style="text-align:left;">
202349_at
</td>
<td style="text-align:left;">
1861
</td>
<td style="text-align:left;">
TOR1A
</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">exp_subset</span><span class="op">&lt;-</span> <span class="va">obj</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">exp</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Probe</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">top_genes</span><span class="op">$</span><span class="va">Probe</span><span class="op">)</span></span>
<span><span class="va">genes</span> <span class="op">&lt;-</span> <span class="va">top_genes</span><span class="op">$</span><span class="va">GeneSymbol</span></span>
<span></span>
<span><span class="co"># ordering design file</span></span>
<span><span class="va">design</span> <span class="op">&lt;-</span> <span class="va">obj</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">design</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">treatment</span>,<span class="va">phenotype</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># shorten the resistance label a bit</span></span>
<span><span class="va">design</span><span class="op">$</span><span class="va">phenotype</span><span class="op">[</span><span class="va">design</span><span class="op">$</span><span class="va">phenotype</span> <span class="op">==</span> <span class="st">"resistant to toward capecitabine, resistant to toward docetaxel trihydrate"</span><span class="op">]</span> <span class="op">=</span> <span class="st">"drug resistant"</span></span>
<span></span>
<span><span class="va">exp_subset</span><span class="op">[</span>,<span class="va">.SD</span>,.SDcols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">design</span><span class="op">)</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">t</span>  <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">scale</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">t</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span>cluster_rows <span class="op">=</span> <span class="cn">FALSE</span>,cluster_cols <span class="op">=</span> <span class="cn">FALSE</span>,labels_row <span class="op">=</span> <span class="va">genes</span>,</span>
<span>             annotation_col <span class="op">=</span><span class="va">design</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">phenotype</span>,<span class="va">treatment</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="metadata_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 class="unnumbered" id="session-info">Session info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<pre><code><span><span class="co">## R version 4.3.2 (2023-10-31)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] pheatmap_1.0.12  kableExtra_1.4.0 knitr_1.45       dplyr_1.1.4     </span></span>
<span><span class="co">## [5] gemma.R_2.1.2    BiocStyle_2.30.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##  [1] rappdirs_0.3.3      sass_0.4.8          utf8_1.2.4         </span></span>
<span><span class="co">##  [4] generics_0.1.3      xml2_1.3.6          stringi_1.8.3      </span></span>
<span><span class="co">##  [7] digest_0.6.34       magrittr_2.0.3      timechange_0.3.0   </span></span>
<span><span class="co">## [10] grid_4.3.2          RColorBrewer_1.1-3  evaluate_0.23      </span></span>
<span><span class="co">## [13] bookdown_0.37       fastmap_1.1.1       jsonlite_1.8.8     </span></span>
<span><span class="co">## [16] BiocManager_1.30.22 httr_1.4.7          purrr_1.0.2        </span></span>
<span><span class="co">## [19] fansi_1.0.6         viridisLite_0.4.2   scales_1.3.0       </span></span>
<span><span class="co">## [22] textshaping_0.3.7   jquerylib_0.1.4     cli_3.6.2          </span></span>
<span><span class="co">## [25] rlang_1.1.3         bit64_4.0.5         munsell_0.5.0      </span></span>
<span><span class="co">## [28] withr_3.0.0         cachem_1.0.8        yaml_2.3.8         </span></span>
<span><span class="co">## [31] tools_4.3.2         memoise_2.0.1       colorspace_2.1-0   </span></span>
<span><span class="co">## [34] assertthat_0.2.1    curl_5.2.0          vctrs_0.6.5        </span></span>
<span><span class="co">## [37] R6_2.5.1            lubridate_1.9.3     lifecycle_1.0.4    </span></span>
<span><span class="co">## [40] stringr_1.5.1       fs_1.6.3            bit_4.0.5          </span></span>
<span><span class="co">## [43] ragg_1.2.7          pkgconfig_2.0.3     desc_1.4.3         </span></span>
<span><span class="co">## [46] gtable_0.3.4        pkgdown_2.0.7       pillar_1.9.0       </span></span>
<span><span class="co">## [49] bslib_0.6.1         data.table_1.15.0   glue_1.7.0         </span></span>
<span><span class="co">## [52] systemfonts_1.0.5   highr_0.10          xfun_0.41          </span></span>
<span><span class="co">## [55] tibble_3.2.1        tidyselect_1.2.0    rstudioapi_0.15.0  </span></span>
<span><span class="co">## [58] farver_2.1.1        htmltools_0.5.7     rmarkdown_2.25     </span></span>
<span><span class="co">## [61] svglite_2.1.3       compiler_4.3.2</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Javier Castillo-Arnemann, Jordan Sicherman, Ogan Mancarci, Guillaume Poirier-Morency.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
