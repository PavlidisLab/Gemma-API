<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>A meta analysis on effects of Parkinson's Disease using Gemma.R • gemma.R</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="A meta analysis on effects of Parkinson's Disease using Gemma.R">
<meta property="og:description" content="gemma.R">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=TODO"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'TODO');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gemma.R</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gemma.R.html">Accessing curated gene expression data with gemma.R</a>
    </li>
    <li>
      <a href="../articles/metanalysis.html">A meta analysis on effects of Parkinson's Disease using Gemma.R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/PavlidisLab/gemma.R/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>A meta analysis on effects of Parkinson’s
Disease using Gemma.R</h1>
                        <h4 data-toc-skip class="author">B. Ogan
Mancarci</h4>
            <address class="author_afil">
      Michael Smith Laboratories, University of British Columbia,
Vancouver, Canada<br><small class="dont-index">Source: <a href="https://github.com/PavlidisLab/gemma.R/blob/HEAD/vignettes/metanalysis.Rmd" class="external-link"><code>vignettes/metanalysis.Rmd</code></a></small>
      <div class="hidden name"><code>metanalysis.Rmd</code></div>

    </address>
</div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://pavlidislab.github.io/gemma.R/" class="external-link">gemma.R</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">poolr</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://magrittr.tidyverse.org" class="external-link">magrittr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></code></pre></div>
<p>Gemma.R contains a large number of datasets representing a wide array
of conditions. It is therefore a useful tool for running meta-analysis
based on publicly available datasets.</p>
<p>In this example we will search Gemma for datasets comparing healthy
controls and patients with Parkinson’s disease, and run a meta-analysis
to discover genes consistently found to be related to the disease.</p>
<div class="section level2">
<h2 id="querying-datasets-of-interest">Querying datasets of interest<a class="anchor" aria-label="anchor" href="#querying-datasets-of-interest"></a>
</h2>
<p><code>search_datasets</code> function can be used to find datasets of
interest, either using ontology terms like “<a href="http://purl.obolibrary.org/obo/DOID_14330" class="external-link uri">http://purl.obolibrary.org/obo/DOID_14330</a>” or plain
text.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># getting all resulting datasets using limit and offset arguments</span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_datasets.html">search_datasets</a></span><span class="op">(</span><span class="st">'http://purl.obolibrary.org/obo/DOID_14330'</span>,limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">$</span><span class="va">totalElements</span></span>
<span></span>
<span><span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">result_count</span>,<span class="fl">100</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/search_datasets.html">search_datasets</a></span><span class="op">(</span><span class="st">'http://purl.obolibrary.org/obo/DOID_14330'</span>,</span>
<span>                    limit <span class="op">=</span> <span class="fl">100</span>,offset <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,<span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">experiment.ShortName</span>,<span class="va">experiment.Name</span>,<span class="va">taxon.Name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></code></pre></div>
<pre><code>   experiment.ShortName
1:              GSE1837
2:                GSE30
3:              GSE4788
4:              GSE1157
5:              GSE6613
6:              GSE7621
                                                                                                         experiment.Name
1:                                           Comparison of  SNc and VTA dopaminergic neurons. Greene-5P50NS038399-050001
2:                     Multiplex three dimensional brain gene expression mapping in a mouse model of Parkinson's disease
3: Dysregulation of Gene Expression in the 1-Methyl-4-Phenyl-1,2,3,6-Tetrahydropyridine-Lesioined Mouse Substantia Nigra
4:                                                                                           NINDS Rat Neuron Parkinsons
5:                                                                         Parkinson's disease vs. controls, whole blood
6:                  Expression data of substantia nigra from postmortem human brain of Parkinson's disease patients (PD)
   taxon.Name
1:        rat
2:      mouse
3:      mouse
4:        rat
5:      human
6:      human</code></pre>
<p>A similar search is also possible using plain text</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/search_datasets.html">search_datasets</a></span><span class="op">(</span><span class="st">'parkinsons'</span>,limit <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">result_count</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/attributes.html" class="external-link">attributes</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span><span class="op">$</span><span class="va">totalElements</span></span>
<span></span>
<span></span>
<span><span class="va">results_plain</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="va">result_count</span>,<span class="fl">100</span><span class="op">)</span>,<span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="../reference/search_datasets.html">search_datasets</a></span><span class="op">(</span><span class="st">'parkinsons'</span>,limit <span class="op">=</span> <span class="fl">100</span>,offset <span class="op">=</span> <span class="va">i</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,<span class="va">.</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">results_plain</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">experiment.ShortName</span>,<span class="va">experiment.Name</span>,<span class="va">taxon.Name</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></code></pre></div>
<pre><code>   experiment.ShortName
1:              GSE1837
2:                GSE30
3:              GSE4788
4:              GSE1157
5:              GSE6613
6:              GSE7621
                                                                                                         experiment.Name
1:                                           Comparison of  SNc and VTA dopaminergic neurons. Greene-5P50NS038399-050001
2:                     Multiplex three dimensional brain gene expression mapping in a mouse model of Parkinson's disease
3: Dysregulation of Gene Expression in the 1-Methyl-4-Phenyl-1,2,3,6-Tetrahydropyridine-Lesioined Mouse Substantia Nigra
4:                                                                                           NINDS Rat Neuron Parkinsons
5:                                                                         Parkinson's disease vs. controls, whole blood
6:                  Expression data of substantia nigra from postmortem human brain of Parkinson's disease patients (PD)
   taxon.Name
1:        rat
2:      mouse
3:      mouse
4:        rat
5:      human
6:      human</code></pre>
<p>These two queries return similar but not-identical results.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># plain text returns more results than the annotation term</span></span>
<span><span class="va">results_plain</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">nrow</span></span></code></pre></div>
<pre><code>[1] 282</code></pre>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">nrow</span></span></code></pre></div>
<pre><code>[1] 161</code></pre>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># annotation term query is a subset of plain text query</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://generics.r-lib.org/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span></span>
<span>    <span class="va">results_plain</span><span class="op">$</span><span class="va">experiment.ShortName</span>,</span>
<span>    <span class="va">results</span><span class="op">$</span><span class="va">experiment.ShortName</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 161</code></pre>
<p>We will be using the results from the annotation term search in the
rest of this analysis since plain text search will match with any
mention of the disease if it is included in the study description.</p>
</div>
<div class="section level2">
<h2 id="filtering-the-datasets-for-suitability">Filtering the datasets for suitability<a class="anchor" aria-label="anchor" href="#filtering-the-datasets-for-suitability"></a>
</h2>
<p>While we know that all the resulting datasets were annotated for the
term for Parkinson’s Disease, we currently do not know how many of them
are comparisons of healthy controls and patients with Parkinson’s
disease. Looking at the sample above, quite a few of them aren’t from
humans in the first place. To find the datasets that are suitable for
our purposes we need to first remove all non-human datasets, then ensure
comparison performed is on Parkinson’s disease patients and controls</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># isolate human datasets</span></span>
<span><span class="va">human_results</span> <span class="op">&lt;-</span> <span class="va">results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">taxon.Name</span> <span class="op">==</span> <span class="st">'human'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">human_results</span><span class="op">)</span></span></code></pre></div>
<pre><code>[1] 106</code></pre>
<p>Next step is to ensure the datasets we are selecting are not affected
by batch confounds. Gemma internally handles batch correction if batch
information is available for the dataset. We will be looking at
<code>geeq.batchEffect</code> column. As explained in the
<code>search_datasets</code> documentation, this column will be set to
-1 for datasets where batch confound is detected, 0 for datasets without
available batch information and to 1 if the data is clear of batch
confounds.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">human_results</span> <span class="op">&lt;-</span> <span class="va">human_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">geeq.batchEffect</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>We now want to ensure that the differential expressions we analyze
compare control and Parkinson’s Disease patients. This information is
available via <code>get_dataset_differential_expression_analyses</code>
which returns the experimental groups for differential expression
analyses performed for the dataset. The columns we are primarily
interested in are
<code>baseline.factorValue</code>/<code>baseline.factorValueURI</code>
which typically records the control group of the differential expression
analysis and
<code>experimental.factorValue</code>/<code>experimental.factorValueURI</code>
which typically records the test case</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">experiment_contrasts</span> <span class="op">&lt;-</span> <span class="va">human_results</span><span class="op">$</span><span class="va">experiment.ShortName</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">out</span> <span class="op">=</span> <span class="fu"><a href="../reference/get_dataset_differential_expression_analyses.html">get_dataset_differential_expression_analyses</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,<span class="va">.</span><span class="op">)</span></span>
<span></span>
<span><span class="va">experiment_contrasts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">experiment.ID</span>,<span class="va">result.ID</span>,</span>
<span>           <span class="va">baseline.factorValue</span>,</span>
<span>           <span class="va">baseline.factorValueURI</span>,</span>
<span>           <span class="va">experimental.factorValue</span>,</span>
<span>           <span class="va">experimental.factorValueURI</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></code></pre></div>
<pre><code>   experiment.ID result.ID             baseline.factorValue
1:           549    515366                           female
2:           549    515365                             &lt;NA&gt;
3:           549    515364           reference subject role
4:           873    542682           reference subject role
5:           873    542683 substantia nigra pars reticulata
6:           873    542683 substantia nigra pars reticulata
                         baseline.factorValueURI       experimental.factorValue
1:   http://purl.obolibrary.org/obo/PATO_0000383                           male
2:                                          &lt;NA&gt;       Parkinson's disease_male
3:    http://purl.obolibrary.org/obo/OBI_0000220            Parkinson's disease
4:    http://purl.obolibrary.org/obo/OBI_0000220            Parkinson's disease
5: http://purl.obolibrary.org/obo/UBERON_0001966 substantia nigra pars compacta
6: http://purl.obolibrary.org/obo/UBERON_0001966         superior frontal gyrus
                                                             experimental.factorValueURI
1:                                           http://purl.obolibrary.org/obo/PATO_0000384
2: http://purl.obolibrary.org/obo/DOID_14330_http://purl.obolibrary.org/obo/PATO_0000384
3:                                             http://purl.obolibrary.org/obo/DOID_14330
4:                                             http://purl.obolibrary.org/obo/DOID_14330
5:                                         http://purl.obolibrary.org/obo/UBERON_0001965
6:                                         http://purl.obolibrary.org/obo/UBERON_0002661</code></pre>
<p>The factor we are interested in is Parkinson’s Disease in
<code>experimental.factorValue</code> or “<a href="http://purl.obolibrary.org/obo/DOID_14330" class="external-link uri">http://purl.obolibrary.org/obo/DOID_14330</a>” in
<code>experimental.factorValueURI</code>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">parkin_contrasts</span> <span class="op">&lt;-</span> <span class="va">experiment_contrasts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">experimental.factorValueURI</span> <span class="op">==</span> <span class="st">"http://purl.obolibrary.org/obo/DOID_14330"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">parkin_contrasts</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">experiment.ID</span>,</span>
<span>           <span class="va">result.ID</span>,</span>
<span>           <span class="va">baseline.factorValue</span>,</span>
<span>           <span class="va">baseline.factorValueURI</span>,</span>
<span>           <span class="va">experimental.factorValue</span>,</span>
<span>           <span class="va">experimental.factorValueURI</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>   experiment.ID result.ID   baseline.factorValue
1:           549    515364 reference subject role
2:           873    542682 reference subject role
3:          1869    552249 reference subject role
4:          1881    529439 reference subject role
5:          1885    529456 reference subject role
6:          2412    522741 reference subject role
                      baseline.factorValueURI experimental.factorValue
1: http://purl.obolibrary.org/obo/OBI_0000220      Parkinson's disease
2: http://purl.obolibrary.org/obo/OBI_0000220      Parkinson's disease
3: http://purl.obolibrary.org/obo/OBI_0000220      Parkinson's disease
4: http://purl.obolibrary.org/obo/OBI_0000220      Parkinson's disease
5: http://purl.obolibrary.org/obo/OBI_0000220      Parkinson's disease
6: http://purl.obolibrary.org/obo/OBI_0000220      Parkinson's disease
                 experimental.factorValueURI
1: http://purl.obolibrary.org/obo/DOID_14330
2: http://purl.obolibrary.org/obo/DOID_14330
3: http://purl.obolibrary.org/obo/DOID_14330
4: http://purl.obolibrary.org/obo/DOID_14330
5: http://purl.obolibrary.org/obo/DOID_14330
6: http://purl.obolibrary.org/obo/DOID_14330</code></pre>
<p>Now that we have our relevant contrasts, we can download them using
<code>get_differential_expression_values</code>. This function can be
used download differential expression fold change and p values, either
using the experiment name/ids or more specifically using the
result.IDs</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">differentials</span> <span class="op">&lt;-</span> <span class="va">parkin_contrasts</span><span class="op">$</span><span class="va">result.ID</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># take the first and only element of the output. the function returns a list </span></span>
<span>    <span class="co"># because single experiments may have multiple resultSets. Here we use the </span></span>
<span>    <span class="co"># resultSet argument to directly access the results we need</span></span>
<span>    <span class="fu"><a href="../reference/get_differential_expression_values.html">get_differential_expression_values</a></span><span class="op">(</span>resultSet <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span></span>
<span></span>
<span><span class="co"># some datasets might not have all the advertised differential expression results</span></span>
<span><span class="co"># calculated due to a variety of factors. here we remove the empty differentials</span></span>
<span></span>
<span><span class="va">missing_contrasts</span> <span class="op">&lt;-</span> <span class="va">differentials</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">nrow</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="op">{</span><span class="va">.</span><span class="op">==</span><span class="fl">0</span><span class="op">}</span></span>
<span><span class="va">differentials</span> <span class="op">&lt;-</span> <span class="va">differentials</span><span class="op">[</span><span class="op">!</span><span class="va">missing_contrasts</span><span class="op">]</span></span>
<span><span class="va">parkin_contrasts</span> <span class="op">&lt;-</span> <span class="va">parkin_contrasts</span><span class="op">[</span><span class="op">!</span><span class="va">missing_contrasts</span>,<span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="getting-the-p-values-for-the-condition-comparison">Getting the p-values for the condition comparison<a class="anchor" aria-label="anchor" href="#getting-the-p-values-for-the-condition-comparison"></a>
</h2>
<p><code>differentials</code> is now a list of data frames containing
the differential expression information. To run a meta-analysis, we need
to p values for the genes from the relevant contrasts.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condition_diffs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_along</a></span><span class="op">(</span><span class="va">differentials</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">i</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="co"># iterate over the differentials</span></span>
<span>    <span class="va">diff</span> <span class="op">=</span> <span class="va">differentials</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="co"># get the contrast information about the differential</span></span>
<span>    <span class="va">contrast</span> <span class="op">=</span> <span class="va">parkin_contrasts</span><span class="op">[</span><span class="va">i</span>,<span class="op">]</span></span>
<span>    <span class="va">p_vals</span> <span class="op">=</span> <span class="va">diff</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'contrast_'</span>,<span class="va">contrast</span><span class="op">$</span><span class="va">contrast.id</span>,<span class="st">"_pvalue"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">log2fc</span> <span class="op">=</span> <span class="va">diff</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'contrast_'</span>,<span class="va">contrast</span><span class="op">$</span><span class="va">contrast.id</span>,<span class="st">"_log2fc"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span>
<span>    <span class="va">genes</span> <span class="op">=</span> <span class="va">diff</span><span class="op">$</span><span class="va">GeneSymbol</span></span>
<span>    </span>
<span>    </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">genes</span>,<span class="va">p_vals</span>,<span class="va">log2fc</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># we can use result.IDs and contrast.IDs to uniquely name this. </span></span>
<span><span class="co"># we add the experiment.id for readability</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">condition_diffs</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">parkin_contrasts</span><span class="op">$</span><span class="va">experiment.ID</span>,<span class="st">'.'</span>,</span>
<span>                                <span class="va">parkin_contrasts</span><span class="op">$</span><span class="va">result.ID</span>,<span class="st">'.'</span>,</span>
<span>                                <span class="va">parkin_contrasts</span><span class="op">$</span><span class="va">contrast.id</span><span class="op">)</span></span>
<span></span>
<span><span class="va">condition_diffs</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></code></pre></div>
<pre><code>      genes    p_vals   log2fc
1     ALMS1 9.548e-03  0.29340
2    PRSS36 3.924e-05 -0.50740
3    SLC5A3 4.354e-06  1.84300
4    AGPAT4 6.912e-01 -0.10740
5 NUDT16-DT 5.978e-01  0.04182
6       DR1 1.389e-01  0.28750</code></pre>
</div>
<div class="section level2">
<h2 id="combining-the-acquired-p-values">Combining the acquired p values<a class="anchor" aria-label="anchor" href="#combining-the-acquired-p-values"></a>
</h2>
<p>We will now apply Fisher’s method to combine p values to find our
genes of interest</p>
<p>First step is to identify which genes are available in our
results</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">all_genes</span> <span class="op">&lt;-</span> <span class="va">condition_diffs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">x</span><span class="op">$</span><span class="va">genes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unique</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">unlist</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">table</span></span>
<span></span>
<span><span class="co"># we will remove any gene that doesn't appear in at least half the results</span></span>
<span><span class="va">all_genes</span> <span class="op">&lt;-</span> <span class="va">all_genes</span><span class="op">[</span><span class="va">all_genes</span><span class="op">&gt;</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">condition_diffs</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="va">all_genes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">all_genes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># remove any probesets matching multiple genes. gemma separates these by using "|"</span></span>
<span><span class="va">all_genes</span> <span class="op">&lt;-</span> <span class="va">all_genes</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"|"</span>,<span class="va">all_genes</span>,fixed <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="co"># remove the "". This comes from probesets not aligned to any genes</span></span>
<span><span class="va">all_genes</span> <span class="op">&lt;-</span> <span class="va">all_genes</span><span class="op">[</span><span class="va">all_genes</span> <span class="op">!=</span> <span class="st">""</span><span class="op">]</span></span>
<span><span class="va">all_genes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">head</span></span></code></pre></div>
<pre><code>[1] "A1BG"   "A1CF"   "A2M"    "A2ML1"  "A4GALT" "A4GNT" </code></pre>
<p>Now we can run the test on every gene, followed by a multiple testing
correction.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fisher_results</span> <span class="op">&lt;-</span> <span class="va">all_genes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">p_vals</span> <span class="op">&lt;-</span> <span class="va">condition_diffs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co"># we will resolve multiple probesets by taking the minimum p value for</span></span>
<span>        <span class="co"># this example</span></span>
<span>        <span class="va">out</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">y</span><span class="op">$</span><span class="va">genes</span> <span class="op">==</span> <span class="va">x</span>,<span class="op">]</span><span class="op">$</span><span class="va">p_vals</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">||</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">out</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">fold_changes</span> <span class="op">&lt;-</span> <span class="va">condition_diffs</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="va">pv</span> <span class="op">=</span> <span class="va">y</span><span class="op">[</span><span class="va">y</span><span class="op">$</span><span class="va">genes</span> <span class="op">==</span> <span class="va">x</span>,<span class="op">]</span><span class="op">$</span><span class="va">p_vals</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pv</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">||</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pv</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">NA</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">y</span><span class="op">[</span><span class="va">y</span><span class="op">$</span><span class="va">genes</span> <span class="op">==</span> <span class="va">x</span>,<span class="op">]</span><span class="op">$</span><span class="va">log2fc</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">pv</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">median_fc</span> <span class="op">=</span> <span class="va">fold_changes</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="va">median</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">median_fc</span><span class="op">)</span> <span class="op">=</span> <span class="st">'Median FC'</span></span>
<span>    </span>
<span>    <span class="va">combined</span> <span class="op">=</span> <span class="va">p_vals</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/poolr/man/fisher.html" class="external-link">fisher</a></span><span class="op">(</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/exposition.html" class="external-link">%$%</a></span> <span class="va">p</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">combined</span><span class="op">)</span> <span class="op">=</span> <span class="st">'Combined'</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p_vals</span>,<span class="va">combined</span>,<span class="va">median_fc</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>,<span class="va">.</span><span class="op">)</span></span>
<span><span class="va">fisher_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">fisher_results</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">fisher_results</span><span class="op">)</span> <span class="op">=</span> <span class="va">all_genes</span></span>
<span></span>
<span><span class="va">fisher_results</span><span class="op">[</span>,<span class="st">'Adjusted'</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html" class="external-link">p.adjust</a></span><span class="op">(</span><span class="va">fisher_results</span><span class="op">[</span>,<span class="st">'Combined'</span><span class="op">]</span>,</span>
<span>                                        method <span class="op">=</span> <span class="st">'fdr'</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fisher_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Adjusted</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">Combined</span>,<span class="va">Adjusted</span>,<span class="va">`Median FC`</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="va">head</span></span></code></pre></div>
<pre><code>            Combined     Adjusted Median FC
CACNA1G 4.376967e-22 3.359760e-18  -0.15780
SV2C    4.207862e-22 3.359760e-18  -0.15850
SLC18A2 8.320978e-20 4.258122e-16  -0.64985
OBSL1   1.011565e-17 3.882387e-14   0.05932
DLK1    4.789217e-17 1.470481e-13  -0.55730
CYB561  1.694509e-16 3.898396e-13  -0.13820</code></pre>
<p>We end up with quite a few differentially expressed genes</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">fisher_results</span><span class="op">$</span><span class="va">Adjusted</span><span class="op">&lt;</span><span class="fl">0.05</span><span class="op">)</span> <span class="co"># FDR&lt;0.05</span></span></code></pre></div>
<pre><code>[1] 10836</code></pre>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">fisher_results</span><span class="op">)</span> <span class="co"># number of all genes</span></span></code></pre></div>
<pre><code>[1] 15352</code></pre>
<p>A quick sanity check would be to look at markers of dopaminergic cell
types and how they rank compared to other genes. Parkinson’s disease is
a neurodegenerative disorder, leading to death of dopaminergic cells. We
should expect them to show up in our results.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># markers are taken from https://www.eneuro.org/content/4/6/ENEURO.0212-17.2017</span></span>
<span><span class="va">dopa_markers</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ADCYAP1"</span>, <span class="st">"ATP2B2"</span>, <span class="st">"CACNA2D2"</span>, </span>
<span><span class="st">"CADPS2"</span>, <span class="st">"CALB2"</span>, <span class="st">"CD200"</span>, <span class="st">"CDK5R2"</span>, <span class="st">"CELF4"</span>, <span class="st">"CHGA"</span>, <span class="st">"CHGB"</span>, </span>
<span><span class="st">"CHRNA6"</span>, <span class="st">"CLSTN2"</span>, <span class="st">"CNTNAP2"</span>, <span class="st">"CPLX1"</span>, <span class="st">"CYB561"</span>, <span class="st">"DLK1"</span>, <span class="st">"DPP6"</span>, </span>
<span><span class="st">"ELAVL2"</span>, <span class="st">"ENO2"</span>, <span class="st">"GABRG2"</span>, <span class="st">"GRB10"</span>, <span class="st">"GRIA3"</span>, <span class="st">"KCNAB2"</span>, <span class="st">"KLHL1"</span>, </span>
<span><span class="st">"LIN7B"</span>, <span class="st">"MAPK8IP2"</span>, <span class="st">"NAPB"</span>, <span class="st">"NR4A2"</span>, <span class="st">"NRIP3"</span>, <span class="st">"HMP19"</span>, <span class="st">"NTNG1"</span>, </span>
<span><span class="st">"PCBP3"</span>, <span class="st">"PCSK1"</span>, <span class="st">"PRKCG"</span>, <span class="st">"RESP18"</span>, <span class="st">"RET"</span>, <span class="st">"RGS8"</span>, <span class="st">"RNF157"</span>, </span>
<span><span class="st">"SCG2"</span>, <span class="st">"SCN1A"</span>, <span class="st">"SLC12A5"</span>, <span class="st">"SLC4A10"</span>, <span class="st">"SLC6A17"</span>, <span class="st">"SLC6A3"</span>, <span class="st">"SMS"</span>, </span>
<span><span class="st">"SNCG"</span>, <span class="st">"SPINT2"</span>, <span class="st">"SPOCK1"</span>, <span class="st">"SYP"</span>, <span class="st">"SYT4"</span>, <span class="st">"TACR3"</span>, <span class="st">"TENM1"</span>, </span>
<span><span class="st">"TH"</span>, <span class="st">"USP29"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">fisher_results</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Combined</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="va">rownames</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="op">{</span><span class="va">.</span><span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">dopa_markers</span><span class="op">}</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span></span>
<span>    <span class="va">which</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> </span>
<span>    <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span>main <span class="op">=</span> <span class="st">'Rank distribution of dopaminergic markers'</span><span class="op">)</span></span></code></pre></div>
<p><img src="metanalysis_files/figure-html/unnamed-chunk-13-1.png" width="700"></p>
<p>We can see that the dopaminergic markers tend to have high ranks in
our results.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Javier Castillo-Arnemann, Jordan Sicherman, Ogan Mancarci, Guillaume Poirier-Morency.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
